$(document).ready(function(){loadList();$(".add-item").click(function(){$.get("/ajax/item/0/add",function(resp){$(".form-container").html(resp).removeClass("hidden").show();handleFormSubmit()});return false})});function loadList(){$.get("/list/items",function(resp){$(".items").html(resp);$("a.edit-link").click(function(){event.preventDefault();var url=$(this).attr("href");$.get(url,function(resp){$(".form-container").html(resp).removeClass("hidden").show();handleFormSubmit()})});$("a.remove-link").click(function(){event.preventDefault();var url=$(this).attr("href");$.get(url,function(resp){if(resp=="OK"){loadList()}else{alert(resp)}})})})}function handleFormSubmit(){$(".item-form").submit(function(){event.preventDefault();var formData=$(this).serialize();var itemId=$('input[name="id"]').val();$.post("/ajax/item/"+itemId+"/save",formData,function(resp){if(resp=="OK"){$(".form-container").hide();loadList()}else{$(".form-container").html(resp);handleFormSubmit()}})})}